(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[986],{8404:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fibonacci-backend-cache/backend-cache-jib-build",function(){return n(8913)}])},8913:function(e,s,n){"use strict";n.r(s),n.d(s,{__toc:function(){return t},default:function(){return h}});var i=n(5893),a=n(2673),l=n(373),r=n(8426);n(9128);var c=n(2643),o={src:"/docs-fibonacci-backend/_next/static/media/1.d1e19a66.png",height:610,width:541,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAICAIAAAC6ZnJRAAAAm0lEQVR42i2MSQ6DIABFPYgjoiAOdSDOVBRLWmJq4qZN73+QYuLib/57eUY9LEIdTc9pe0dx4aPUC2IjjG5cHeP8zGlf1qMGjh8ZpgXKYVn3b9NNAcltgE/XtP1KR/ZfUXYkoy4k5+sAjLKayTnOsAuT69WzPDRwMT9Ux1aIUw10AVImlven7XmUVpeLSD7JjcttEi/aMBAmLiR/WaAgvdLAVdoAAAAASUVORK5CYII=",blurWidth:7,blurHeight:8};let t=[{depth:2,value:"Gradle Jib 빌드 정의, 이미지 생성, 푸시",id:"gradle-jib-빌드-정의-이미지-생성-푸시"},{depth:2,value:"참고",id:"참고"},{depth:2,value:"Java/Kotlin 애플리케이션의 도커이미지 빌드 방식",id:"javakotlin-애플리케이션의-도커이미지-빌드-방식"},{depth:2,value:"Gradle Jib 으로 Docker 이미지 빌드 & 푸시",id:"gradle-jib-으로-docker-이미지-빌드--푸시"},{depth:3,value:"plugin 추가",id:"plugin-추가"},{depth:3,value:"빌드스크립트 작성",id:"빌드스크립트-작성"},{depth:3,value:"빌드 & Push",id:"빌드--push"},{depth:4,value:"intellij 내에서 jib 태스크 실행",id:"intellij-내에서-jib-태스크-실행"},{depth:4,value:"gradlew 명령어로 실행",id:"gradlew-명령어로-실행"},{depth:3,value:"컨테이너 이미지 동작 확인",id:"컨테이너-이미지-동작-확인"},{depth:2,value:"Dockerfile 로 Docker 이미지 빌드 & 푸시",id:"dockerfile-로-docker-이미지-빌드--푸시"},{depth:3,value:"Dockerfile 정의, 빌드 & 푸시",id:"dockerfile-정의-빌드--푸시"},{depth:2,value:"이미지 리포지터리",id:"이미지-리포지터리"}];function _createMdxContent(e){let s=Object.assign({h2:"h2",p:"p",ul:"ul",li:"li",a:"a",h3:"h3",pre:"pre",code:"code",span:"span",h4:"h4",img:"img"},(0,c.a)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h2,{id:"gradle-jib-빌드-정의-이미지-생성-푸시",children:"Gradle Jib 빌드 정의, 이미지 생성, 푸시"}),"\n",(0,i.jsx)(s.p,{children:"도커이미지를 빌드,푸시하는 방식에 대해 정리해봅니다. Gradle Jib 빌드 방식에 대해서 정리하지만, Dockerfile 로 빌드하는 방식에 대해서도 문서의 마지막에 추가로 정리해두겠습니다."}),"\n",(0,i.jsx)(s.h2,{id:"참고",children:"참고"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://github.com/GoogleContainerTools/jib/tree/master/jib-gradle-plugin",children:"github.com/jib/jib-gradle-plugin"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://github.com/GoogleContainerTools/jib",children:"github.com/GoogleContainerTools/jib"})}),"\n"]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h2,{id:"javakotlin-애플리케이션의-도커이미지-빌드-방식",children:"Java/Kotlin 애플리케이션의 도커이미지 빌드 방식"}),"\n",(0,i.jsx)(s.p,{children:"Java/Kotlin 애플리케이션의 Gradle 빌드 시 두가지를 선택할 수 있습니다"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Gradle Jib 플러그인을 사용하는 빌드 & 푸시"}),"\n",(0,i.jsx)(s.li,{children:"Dockerfile 정의, Shell Script 를 이용한 빌드 & 푸시"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"두 방법 중에는 일반적으로 Gradle Jib 을 이용한 방식이 많이 사용되는 편입니다."}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h2,{id:"gradle-jib-으로-docker-이미지-빌드--푸시",children:"Gradle Jib 으로 Docker 이미지 빌드 & 푸시"}),"\n",(0,i.jsx)(s.h3,{id:"plugin-추가",children:"plugin 추가"}),"\n",(0,i.jsx)(s.pre,{"data-language":"groovy","data-theme":"default",filename:"build.gradle",hasCopyCode:!0,children:(0,i.jsxs)(s.code,{"data-language":"groovy","data-theme":"default",children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"plugins {"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	id "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'com.google.cloud.tools.jib'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" version "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'3.4.0'"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsxs)(s.p,{children:["코틀린 DSL의 ",(0,i.jsx)(s.code,{children:"build.gradle.kts"})," 파일에서는 아래와 같이 작성합니다."]}),"\n",(0,i.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"plugins"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"com.google.cloud.tools.jib"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") version "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"3.4.0"'})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h3,{id:"빌드스크립트-작성",children:"빌드스크립트 작성"}),"\n",(0,i.jsx)(s.pre,{"data-language":"groovy","data-theme":"default",filename:"build.gradle",hasCopyCode:!0,children:(0,i.jsxs)(s.code,{"data-language":"groovy","data-theme":"default",children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"jib {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	from {"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		image "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"amazoncorretto:17"'})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	}"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	to{"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		image "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"chagchagchag/fibonacci-backend-cache"'})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		tags "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0.0.1"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0.0.1.fibonacci-backend-cache.01"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"latest"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ]"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	}"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	container{"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		creationTime "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"USE_CURRENT_TIMESTAMP"'})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	}"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsxs)(s.p,{children:["위의 빌드스크립트의 경우 코틀린 문법과 다른 부분이 없기에 코틀린 DSL 의 ",(0,i.jsx)(s.code,{children:"build.gradle.kts"})," 파일을 작성시에도 위의 내용을 그대로 사용하면 됩니다."]}),"\n",(0,i.jsx)(s.p,{children:"젠킨스나 Github CI에서 빌드하는 것이 아닌 경우 개발자의 PC에 따라 CPU 가 달라지는 것으로 인해 애플 M1 등 여러가지 빌드 옵션을 직접 추가하거나 이런 작업들이 필요한 경우가 있습니다."}),"\n",(0,i.jsx)(s.p,{children:"이런 경우 jib 내의 from 구문에 아래와 같은 내용을 작성해주시면 됩니다."}),"\n",(0,i.jsx)(s.pre,{"data-language":"groovy","data-theme":"default",filename:"build.gradle",hasCopyCode:!0,children:(0,i.jsxs)(s.code,{"data-language":"groovy","data-theme":"default",children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"jib {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    from {"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        image "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"amazoncorretto:17"'})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        platforms {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            platform{"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                architecture "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"arm64"'})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                os "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"linux"'})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)(s.p,{children:["회사에서 실제 개발 작 시 필요한 내용들을 정의할 때 세부적인 내용들이 많이 필요할 수 있는데 자세한 설명은 ",(0,i.jsx)(s.a,{href:"https://github.com/GoogleContainerTools/jib/tree/master/jib-gradle-plugin",children:"github.com/jib/jib-gradle-plugin"})," 에서 확인할 수 있습니다."]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h3,{id:"빌드--push",children:"빌드 & Push"}),"\n",(0,i.jsxs)(s.p,{children:["이렇게 작성한 build 스크립트는 gradle 명령어로 빌드할 수도 있고, intellij 에서 jib 태스크를 실행해서 도커이미지를 빌드 후 푸시할 수도 있습니다.",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.p,{children:["참고로 개발 PC에서 빌드 실행 시 Docker Desktop 이 실행 중이어야 합니다.",(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h4,{id:"intellij-내에서-jib-태스크-실행",children:"intellij 내에서 jib 태스크 실행"}),"\n",(0,i.jsxs)(s.p,{children:["인텔리제이 내에서는 아래와 같이 jib 태스크 버튼을 눌러서 태스크를 실행해주시면 됩니다.\r\n",(0,i.jsx)(s.img,{placeholder:"blur",src:o})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h4,{id:"gradlew-명령어로-실행",children:"gradlew 명령어로 실행"}),"\n",(0,i.jsx)(s.p,{children:"gradlew 명령어로 실행하는 것은 아래와 같이 하면 됩니다."}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsx)(s.code,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./gradlew"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"fibonacci-backend-cache:jib"})]})})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h3,{id:"컨테이너-이미지-동작-확인",children:"컨테이너 이미지 동작 확인"}),"\n",(0,i.jsx)(s.p,{children:"도커 이미지 pull (만약 로컬에 이미지가 없다면)"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsx)(s.code,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"docker"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"pull"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"chagchagchag/fibonacci-backend-cache:0.0.1"})]})})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.p,{children:"도커 이미지 구동"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"docker"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"container"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"run"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--rm"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-d"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-p"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"8080"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:":8080"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--name"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"fibonacci-backend-cache-local"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"chagchagchag/fibonacci-backend-cache:0.0.1"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"8ecabf9735e9fea5a0416b52fb5780dcb10841515240e5d55483612f6ebb16eb"})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.p,{children:"동작 확인"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"curl"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"http://localhost:8080/probe/healthcheck"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"OK"})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.p,{children:"종료"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"docker"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"container"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"stop"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"fibonacci-backend-cache-local"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"fibonacci-backend-cache-local"})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h2,{id:"dockerfile-로-docker-이미지-빌드--푸시",children:"Dockerfile 로 Docker 이미지 빌드 & 푸시"}),"\n",(0,i.jsx)(s.h3,{id:"dockerfile-정의-빌드--푸시",children:"Dockerfile 정의, 빌드 & 푸시"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"Dockerfile_simple"})}),"\n",(0,i.jsx)(s.pre,{"data-language":"Dockerfile","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"Dockerfile","data-theme":"default",children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"FROM amazoncorretto:17"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"WORKDIR deploy"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"COPY build/libs/fibonacci_backend_cache-0.0.1.jar app.jar"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'ENTRYPOINT ["java", "-jar", "app.jar"]'})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.p,{children:"이미지 빌드"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsx)(s.code,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"docker"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"build"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-f"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"Dockerfile_simple"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--tag"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"chagchagchag/fibonacci-backend-cache-simple:0.0.1"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"."})]})})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.p,{children:"컨테이너 구동"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"docker"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"container"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"run"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--name"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"fibonacci-backend-cache-simple"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--rm"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-d"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-p"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"8080"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:":8080"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"chagchagchag/fibonacci-backend-cache-simple:0.0.1"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"cf160b8e1ae294b1d354463ea52a2e254be3bfb3f1066616f95c0e1421423629"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:" "}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"## 확인"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"docker"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"container"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ls"})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"CONTAINER"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ID"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"IMAGE"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                                               "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"COMMAND"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"               "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"CREATED"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"         "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"STATUS"})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"PORTS"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                    "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"NAMES"})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"cf160b8e1ae2"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"chagchagchag/fibonacci-backend-cache-simple:0.0.1"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"java -jar app.jar"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"6"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"seconds"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"ago"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"Up"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"seconds"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0.0"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:".0.0:8080"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"-"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"8080/tcp"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"fibonacci-backend-cache-simple"})]})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.p,{children:"API 확인"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"curl"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"http://localhost:8080/probe/healthcheck"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"OK"})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.p,{children:"종료&삭제"}),"\n",(0,i.jsx)(s.pre,{"data-language":"bash","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"$"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"docker"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"container"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"stop"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"fibonacci-backend-cache-simple"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"fibonacci-backend-cache-simple"})})]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(s.h2,{id:"이미지-리포지터리",children:"이미지 리포지터리"}),"\n",(0,i.jsxs)(s.p,{children:["예전의 레거시 개발 방식에서는 Docker 이미지라는 것이 필요가 없었습니다. 현재는 Docker Container 방식의 이미지를 구동하는 방식이 대중화되어 있습니다. 이때 이미지 리포지터리에 개발버전이 잘못 Push 될 수 있는 경우가 있습니다.",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.p,{children:["이런 이유로 가급적이면 개발 용도의 이미지 리포지터리와 Deploy (배포) 전용 이미지 리포지터리를 따로 운영해서 Github Action 등에서만 사용하는 Deploy 전용 이미지 리포지터리를 사용하는 것을 권장드립니다.",(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)(s.p,{children:["보통 이미지 리포지터리는 S3 방식으로 운영되는 것으로 알고 있습니다. 따라서 AWS에서 ECR 을 운영,개발 용도로 분리해서 사용한다고 하더라도 용량에 큰 부담도 없고 비용이 그렇게 크게 발생하지는 않을 듯 해보입니다.",(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)("br",{})]})}let d={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.a)(),e.components);return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/fibonacci-backend-cache/backend-cache-jib-build.mdx",route:"/fibonacci-backend-cache/backend-cache-jib-build",timestamp:1708403886e3,pageMap:[{kind:"Folder",name:"fibonacci-backend-cache",route:"/fibonacci-backend-cache",children:[{kind:"MdxPage",name:"backend-cache-coding",route:"/fibonacci-backend-cache/backend-cache-coding"},{kind:"MdxPage",name:"backend-cache-graceful-shutdown",route:"/fibonacci-backend-cache/backend-cache-graceful-shutdown"},{kind:"MdxPage",name:"backend-cache-jib-build",route:"/fibonacci-backend-cache/backend-cache-jib-build"},{kind:"MdxPage",name:"backend-cache-k8s-yaml",route:"/fibonacci-backend-cache/backend-cache-k8s-yaml"},{kind:"MdxPage",name:"backend-cache-kustomize",route:"/fibonacci-backend-cache/backend-cache-kustomize"},{kind:"MdxPage",name:"backend-cache-perf-test",route:"/fibonacci-backend-cache/backend-cache-perf-test"},{kind:"MdxPage",name:"introduce-fibonacci-backend-cache",route:"/fibonacci-backend-cache/introduce-fibonacci-backend-cache"},{kind:"Meta",data:{"introduce-fibonacci-backend-cache":"소개","backend-cache-coding":"Backend 코드 작업","backend-cache-jib-build":"Gradle Jib 빌드 정의, 이미지 생성, 푸시","backend-cache-k8s-yaml":"k8s 리소스 정의 & 로컬 k8s 확인","backend-cache-kustomize":"Kustomize Overlay 작업","backend-cache-graceful-shutdown":"Graceful Shutdown 처리","backend-cache-perf-test":"부하테스트"}}]},{kind:"Folder",name:"fibonacci-backend-web",route:"/fibonacci-backend-web",children:[{kind:"MdxPage",name:"backend-web-coding",route:"/fibonacci-backend-web/backend-web-coding"},{kind:"MdxPage",name:"backend-web-graceful-shutdown",route:"/fibonacci-backend-web/backend-web-graceful-shutdown"},{kind:"MdxPage",name:"backend-web-hpa-testing",route:"/fibonacci-backend-web/backend-web-hpa-testing"},{kind:"MdxPage",name:"backend-web-jib-build",route:"/fibonacci-backend-web/backend-web-jib-build"},{kind:"MdxPage",name:"backend-web-k8s-yaml",route:"/fibonacci-backend-web/backend-web-k8s-yaml"},{kind:"MdxPage",name:"backend-web-kustomize",route:"/fibonacci-backend-web/backend-web-kustomize"},{kind:"MdxPage",name:"backend-web-perf-test",route:"/fibonacci-backend-web/backend-web-perf-test"},{kind:"MdxPage",name:"introduce-fibonacci-backend-web",route:"/fibonacci-backend-web/introduce-fibonacci-backend-web"},{kind:"Meta",data:{"introduce-fibonacci-backend-web":"소개","backend-web-coding":"Backend 코드 작업","backend-web-jib-build":"Gradle Jib 빌드 정의, 이미지 생성, 푸시","backend-web-k8s-yaml":"k8s 리소스 정의 & 로컬 k8s 확인","backend-web-hpa-testing":"HPA 정의 및 테스트","backend-web-kustomize":"Kustomize Overlay 작업","backend-web-graceful-shutdown":"Graceful Shutdown 처리","backend-web-perf-test":"부하테스트"}}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"kubernetes-overview",route:"/kubernetes-overview",children:[{kind:"MdxPage",name:"hostPath-emptyDir",route:"/kubernetes-overview/hostPath-emptyDir"},{kind:"MdxPage",name:"intro",route:"/kubernetes-overview/intro"},{kind:"MdxPage",name:"kubernetes-resource-assignment",route:"/kubernetes-overview/kubernetes-resource-assignment"},{kind:"MdxPage",name:"kubernetes-scaling",route:"/kubernetes-overview/kubernetes-scaling"},{kind:"MdxPage",name:"PV-PVC",route:"/kubernetes-overview/PV-PVC"},{kind:"MdxPage",name:"storage-class",route:"/kubernetes-overview/storage-class"},{kind:"MdxPage",name:"window-directory-k8s-mount",route:"/kubernetes-overview/window-directory-k8s-mount"},{kind:"Meta",data:{intro:"소개","kubernetes-scaling":"쿠버네티스의 스케일링","kubernetes-resource-assignment":"쿠버네티스의 자원 할당","hostPath-emptyDir":"hostPath, emptyDir","PV-PVC":"PV, PVC","storage-class":"스토리지 클래스","window-directory-k8s-mount":"kubernetes hostPath 지정시 윈도우 WSL 디렉터리 경로"}}]},{kind:"Folder",name:"setup",route:"/setup",children:[{kind:"MdxPage",name:"deploy-environment",route:"/setup/deploy-environment"},{kind:"MdxPage",name:"local-k8s-setup",route:"/setup/local-k8s-setup"},{kind:"MdxPage",name:"redis-environment",route:"/setup/redis-environment"},{kind:"MdxPage",name:"reference",route:"/setup/reference"},{kind:"Meta",data:{"local-k8s-setup":"로컬 k8s 셋업","deploy-environment":"배포환경","redis-environment":"레디스 환경설정",reference:"참고한 스터디 자료들"}}]},{kind:"Meta",data:{index:"Introduction",setup:"SETUP","fibonacci-backend-cache":"fibonacci-backend-cache","fibonacci-backend-web":"fibonacci-backend-web",contact:{title:"Contact ↗",type:"page",href:"-",newWindow:!0}}}],flexsearch:{codeblocks:!0},title:"Backend Cache Jib Build",headings:t},pageNextRoute:"/fibonacci-backend-cache/backend-cache-jib-build",nextraLayout:l.ZP,themeConfig:r.Z};var h=(0,a.j)(d)},8426:function(e,s,n){"use strict";var i=n(5893);n(7294);let a={logo:(0,i.jsx)("span",{children:"My Project"}),project:{link:"https://github.com/chagchagchag/docs-fibonacci-backend"},docsRepositoryBase:"https://github.com/chagchagchag/docs-fibonacci-backend",footer:{text:"Nextra Docs Template"}};s.Z=a},5789:function(){}},function(e){e.O(0,[774,796,888,179],function(){return e(e.s=8404)}),_N_E=e.O()}]);